<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kore SavaÅŸÄ± â€” TÃ¼rk Askeri</title>
<style>
:root{--bg:#07162b;--accent:#ffb74d;--muted:#bfbfbf}
html,body{height:100%;margin:0;overflow:hidden;background:var(--bg);color:#A020F0;font-family:monospace}
#startMenu{position:absolute;inset:0;z-index:60;display:flex;align-items:center;justify-content:center}
.menu-card{width:min(760px,94%);background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.08));border-radius:12px;padding:18px;box-shadow:0 12px 40px rgba(0,0,0,0.6);display:flex;gap:12px;align-items:center}
.menu-left{flex:1}
h1.title{margin:0;font-size:30px;color:var(--accent);text-shadow:0 6px 18px rgba(0,0,0,0.6)}
p.lead{color:var(--muted);margin-top:8px;line-height:1.4}
.controls{margin-top:12px;display:flex;gap:10px}
.btn{background:var(--accent);color:#111;border:none;padding:10px 12px;border-radius:10px;font-weight:700;cursor:pointer}
.btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff}
.preview{width:220px;height:140px;border-radius:8px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:transparent}
#info{position:absolute;top:10px;width:100%;text-align:center;color:#eee;font-size:15px;z-index:50;text-shadow:1px 1px #000}
#gameOverScreen,#levelScreen{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:white;text-align:center;display:none;z-index:80}
#mobileControls{
    display:none;
    position:absolute;
    bottom:18px;
    left:50%;
    transform:translateX(-50%);
    display:grid;
    grid-template-areas:
        ". up ."
        "left fire right"
        ". down .";
    gap:10px;
    z-index:40;
}
#upBtn{grid-area: up;}
#downBtn{grid-area: down;}
#leftBtn{grid-area: left;}
#rightBtn{grid-area: right;}
#fireBtn{grid-area: fire;}
.ctrlBtn{width:72px;height:72px;border-radius:50%;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.08);display:inline-flex;align-items:center;justify-content:center;font-size:28px;color:#fff}
#soundBtn{position:absolute;top:12px;right:12px;z-index:90;padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:rgba(0,0,0,0.3);cursor:pointer}
#gameCanvas{display:block;position:fixed;inset:0;width:100%;height:100%;image-rendering:pixelated;z-index:10}
.footer-note{position:absolute;left:12px;bottom:12px;color:var(--muted);z-index:70;font-size:12px}
@media (max-width:820px){ .menu-card{flex-direction:column;align-items:stretch} .preview{width:100%;height:120px} h1.title{font-size:22px} }
</style>
</head>
<body>
  <div id="startMenu">
    <div class="menu-card">
      <div class="menu-left">
        <h1 class="title">Kore SavaÅŸÄ±nda bir TÃœRK askerisin</h1>
        <p class="lead">GÃ¶revin: DÃ¼ÅŸman hatlarÄ±nÄ± yarÄ±p birliklerini korumak. Hareket: W/A/S/D veya ok tuÅŸlarÄ±. AteÅŸ: SPACE. Mobil iÃ§in "Mobile ile Oyna" butonuna bas.</p>
        <div class="controls">
          <button class="btn" id="startBtn">PC ile Oyna</button>
          <button class="btn" id="mobileBtn">Mobile ile Oyna</button>
          <button class="btn ghost" id="howBtn">NasÄ±l OynanÄ±r</button>
        </div>
      </div>
      <div>
        <div class="preview"><canvas id="previewCanvas" width="220" height="140" style="width:100%;height:100%;display:block"></canvas></div>
        <div style="margin-top:8px;color:var(--muted);font-size:13px">Åžehitlerimizi Ve Gazilerimizi SaygÄ± ile AnÄ±yoruz... </div>
      </div>
    </div>
  </div>

  <div id="info">Kore SavaÅŸÄ± â€” TÃ¼rk Askeri</div>
  <div id="levelScreen"></div>
  <div id="gameOverScreen"><h1>OYUN BÄ°TTÄ°</h1><p id="finalScore"></p><button onclick="restartGame()">Yeniden Oyna</button></div>

  <button id="soundBtn">Ses: AÃ§</button>

  <div id="mobileControls">
    <button class="ctrlBtn" id="upBtn">â–²</button>
    <button class="ctrlBtn" id="leftBtn">â—€</button>
    <button class="ctrlBtn" id="fireBtn">ðŸ”¥</button>
    <button class="ctrlBtn" id="rightBtn">â–¶</button>
    <button class="ctrlBtn" id="downBtn">â–¼</button>
  </div>
  <canvas id="gameCanvas"></canvas>
  <div class="footer-note">Kore SavaÅŸÄ± â€” TÃ¼rk Askeri</div>

<script>
/* ---------- setup ---------- */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const preview = document.getElementById('previewCanvas');
const pctx = preview.getContext('2d');
canvas.width = innerWidth; canvas.height = innerHeight;

let keys = {};
addEventListener('keydown', e=>keys[e.key.toLowerCase()]=true);
addEventListener('keyup', e=>keys[e.key.toLowerCase()]=false);

/* game state */
let player, bullets=[], enemies=[], enemyBullets=[], explosions=[];
let healthPacks = []; 
let score=0, gameOver=false;
let stars=[], clouds=[], bgX=0, screenMiddle = canvas.width/2;
let spawnInterval = null;
let mobileMode=false;

/* ---------- GÃ–RSELLER ---------- */
const spriteImg = new Image();
spriteImg.src = 'ASKER.png'; 

const dusmanUcakImg = new Image();
dusmanUcakImg.src = 'ucak.png'; // Senin gÃ¶nderdiÄŸin uÃ§ak gÃ¶rseli

const PLAYER_SCALE = 0.2; 
let modelW = 100; 
let modelH = 100;

spriteImg.onload = () => {
  modelW = spriteImg.width * PLAYER_SCALE;
  modelH = spriteImg.height * PLAYER_SCALE;
};

/* ---------- AUDIO ---------- */
let audioCtx = null;
let masterGain = null;
let soundOn = true;
function ensureAudio(){
  if(!audioCtx){
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    masterGain = audioCtx.createGain();
    masterGain.gain.value = 0.9;
    masterGain.connect(audioCtx.destination);
  }
}
function playShootSound(){
  if(!soundOn) return;
  ensureAudio();
  const t = audioCtx.currentTime;
  const o = audioCtx.createOscillator(); o.type='square'; o.frequency.setValueAtTime(900, t);
  const g = audioCtx.createGain(); g.gain.setValueAtTime(0.0001, t); g.gain.linearRampToValueAtTime(0.2, t+0.01); g.gain.exponentialRampToValueAtTime(0.0001, t+0.2);
  o.connect(g); g.connect(masterGain); o.start(t); o.stop(t+0.21);
}
function playEnemyShootSound(){
  if(!soundOn) return;
  ensureAudio();
  const t = audioCtx.currentTime;
  const o = audioCtx.createOscillator(); o.type='sine'; o.frequency.setValueAtTime(420, t);
  const g = audioCtx.createGain(); g.gain.setValueAtTime(0.0001,t); g.gain.linearRampToValueAtTime(0.1,t+0.01); g.gain.exponentialRampToValueAtTime(0.0001,t+0.3);
  o.connect(g); g.connect(masterGain); o.start(t); o.stop(t+0.32);
}
function playHitSound(){
  if(!soundOn) return;
  ensureAudio();
  const t = audioCtx.currentTime;
  const o = audioCtx.createOscillator(); o.type='triangle'; o.frequency.setValueAtTime(160, t);
  const g = audioCtx.createGain(); g.gain.setValueAtTime(0.0001,t); g.gain.linearRampToValueAtTime(0.4,t+0.01); g.gain.exponentialRampToValueAtTime(0.0001,t+0.25);
  o.connect(g); g.connect(masterGain); o.start(t); o.stop(t+0.26);
}
function playExplosionSound(){
  if(!soundOn) return;
  ensureAudio();
  const t = audioCtx.currentTime;
  for(let i=0;i<3;i++){
    const o = audioCtx.createOscillator(); o.type='sawtooth'; o.frequency.setValueAtTime(120 + i*40, t);
    const g = audioCtx.createGain(); g.gain.setValueAtTime(0.0001,t); g.gain.linearRampToValueAtTime(0.2,t+0.01); g.gain.exponentialRampToValueAtTime(0.0001,t+0.5);
    o.connect(g); g.connect(masterGain); o.start(t); o.stop(t+0.5);
  }
}

function initPreview(){
  pctx.clearRect(0,0,preview.width,preview.height);
  for(let i=0;i<40;i++){
    pctx.fillStyle = ['#ffb74d','#ff8a65','#81d4fa'][i%3];
    pctx.beginPath(); pctx.arc(Math.random()*preview.width, Math.random()*preview.height, 2+Math.random()*3, 0, Math.PI*2); pctx.fill();
  }
}
initPreview();

function drawSky(){
  const g = ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0,'#01203a'); g.addColorStop(0.5,'#063049'); g.addColorStop(1,'#071326');
  ctx.fillStyle = g; ctx.fillRect(0,0,canvas.width,canvas.height);
  stars.forEach(s=>{
    const x = (s.x - bgX * s.speed*0.02 + canvas.width) % canvas.width;
    ctx.fillStyle='#fff'; ctx.globalAlpha = 0.6; ctx.fillRect(x, s.y, s.s, s.s); ctx.globalAlpha = 1;
  });
  clouds.forEach(c=>{
    c.x -= c.speed;
    if(c.x + c.w < -50) c.x = canvas.width + 50;
    ctx.fillStyle = 'rgba(255,255,255,0.12)';
    ctx.beginPath(); ctx.ellipse(c.x, c.y, c.w, c.h, 0, 0, Math.PI*2); ctx.fill();
  });
  bgX += 1.2;
}

/* ---------- Entities ---------- */
function initEntities(){
  player = {
    x:50, y:canvas.height/2 - 50,
    w: modelW || 80, h: modelH || 80,
    speed:6, lives:3,
    flash: 0 
  };
  bullets = []; enemies = []; enemyBullets = []; explosions = [];
  healthPacks = [];
  score=0; gameOver=false;
  stars=[]; clouds=[];
  for(let i=0;i<120;i++) stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, s:Math.random()*2+0.6, speed:0.2+Math.random()*1.2});
  for(let i=0;i<28;i++) clouds.push({x:Math.random()*canvas.width, y:50+Math.random()*130, w:100+Math.random()*200, h:25+Math.random()*30, speed:0.2+Math.random()*0.6});
  if(spawnInterval) clearInterval(spawnInterval);
  spawnInterval = setInterval(()=>{ if(!gameOver) spawnEnemy(); }, 900);
}

function spawnEnemy(){
  // DÃ¼ÅŸman uÃ§aÄŸÄ± iÃ§in boyut ayarÄ±
  const w = 440; 
  const h = 240;
  enemies.push({ 
    x: canvas.width, 
    y: Math.random()*(canvas.height-h), 
    w: w, 
    h: h, 
    speed: 3 + Math.random()*2, 
    hp: 1, 
    shootCooldown: 80 + Math.floor(Math.random()*120) 
  });
}

function enemyShoot(en){
  if(!en) return;
  enemyBullets.push({ x: en.x, y: en.y + en.h/2 + 5, w:10, h:5, speed: -9, color:'#ff4444' });
  playEnemyShootSound();
}

function shoot(){
  if(!player || gameOver) return;
  bullets.push({ x: player.x + player.w - 10, y: player.y + player.h/2 + 5, w:12, h:4, speed:15, color:'#ffff00' });
  playShootSound();
}

function createExplosion(x,y){
  explosions.push({ x,y, r:0, max:40, t:0 });
  playExplosionSound();
}

function createHealthPack(x, y) {
    healthPacks.push({
        x: x, y: y, w: 25, h: 25,
        speed: 1.5, color: '#4CAF50', glow: 'rgba(76, 175, 80, 0.4)'
    });
}

function overlap(a,b){ return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y; }

/* ---------- Ã‡izim FonksiyonlarÄ± ---------- */
function drawPlayer(){
  if(player.flash > 0) {
      player.flash--;
      if(player.flash % 4 < 2) return;
  }
  if(spriteImg.complete){
    ctx.drawImage(spriteImg, player.x, player.y, player.w, player.h);
  } else {
    ctx.fillStyle = '#00ff00';
    ctx.fillRect(player.x, player.y, player.w, player.h);
  }
}

function drawEnemies(){
  enemies.forEach(e => {
    if(dusmanUcakImg.complete){
      // UÃ§ak sola baktÄ±ÄŸÄ± iÃ§in gÃ¶rseli Ã§eviriyoruz (isteÄŸe baÄŸlÄ±)
      ctx.save();
      ctx.translate(e.x + e.w, e.y);
      ctx.scale(-1, 1);
      ctx.drawImage(dusmanUcakImg, 0, 0, e.w, e.h);
      ctx.restore();
    } else {
      ctx.fillStyle = '#ff6b6b';
      ctx.fillRect(e.x, e.y, e.w, e.h);
    }
  });
}

/* ---------- main loop ---------- */
let lastTS = 0;
let running = false;

function loop(timestamp){
  if(!running) return;
  const dt = timestamp - lastTS || 16;
  lastTS = timestamp;

  drawSky();

  if(keys['arrowup']||keys['w']) { player.y = Math.max(0, player.y - player.speed); }
  if(keys['arrowdown']||keys['s']) { player.y = Math.min(canvas.height - player.h, player.y + player.speed); }
  if(keys['arrowleft']||keys['a']) { player.x = Math.max(0, player.x - player.speed); }
  if(keys['arrowright']||keys['d']) { player.x = Math.min(screenMiddle - player.w, player.x + player.speed); }

  if(mobileMode){
    if(window._mobileUp) player.y = Math.max(0, player.y - player.speed);
    if(window._mobileDown) player.y = Math.min(canvas.height - player.h, player.y + player.speed);
    if(window._mobileLeft) player.x = Math.max(0, player.x - player.speed);
    if(window._mobileRight) player.x = Math.min(screenMiddle - player.w, player.x + player.speed);
  }

  bullets.forEach((b,i)=>{ b.x += b.speed; if(b.x > canvas.width) bullets.splice(i,1); });

  enemies.forEach((en, ei)=>{
    en.x -= en.speed;
    en.shootCooldown--;
    if(en.shootCooldown <= 0){
      enemyShoot(en);
      en.shootCooldown = 60 + Math.floor(Math.random()*120);
    }
    bullets.forEach((b, bi)=>{
      if(overlap(b,en)){
        bullets.splice(bi,1);
        en.hp--;
        createExplosion(en.x + en.w/2, en.y + en.h/2);
        playHitSound();
        if(en.hp <= 0){
          enemies.splice(ei,1);
          score += 10;
          if(Math.random() < 0.15) createHealthPack(en.x, en.y);
        }
      }
    });
    if(en.x + en.w < -50) enemies.splice(ei,1);
  });

  enemyBullets.forEach((eb, i)=>{
    eb.x += eb.speed;
    if(eb.x + eb.w < 0) { enemyBullets.splice(i,1); return; }
    if(overlap(eb, player)){
      enemyBullets.splice(i,1);
      player.lives = Math.max(0, player.lives - 1);
      player.flash = 20;
      createExplosion(player.x + player.w/2, player.y + player.h/2);
      playHitSound();
      if(player.lives <= 0){
        gameOver = true;
        running = false;
        document.getElementById('finalScore').innerText = 'Toplam Puan: ' + score;
        document.getElementById('gameOverScreen').style.display = 'block';
      }
    }
  });
  
  healthPacks.forEach((hp, hpi) => {
      hp.x -= hp.speed;
      if(hp.x + hp.w < 0) { healthPacks.splice(hpi, 1); return; }
      if(overlap(hp, player)){
          healthPacks.splice(hpi, 1);
          player.lives = Math.min(3, player.lives + 1);
          playShootSound();
      }
  });

  explosions.forEach((ex, idx)=>{
    ex.t += dt;
    ex.r = Math.min(ex.max, ex.r + dt*0.06);
    ctx.beginPath(); ctx.fillStyle = `rgba(255,180,60,${1 - ex.r/ex.max})`; ctx.arc(ex.x, ex.y, ex.r, 0, Math.PI*2); ctx.fill();
    if(ex.r >= ex.max) explosions.splice(idx,1);
  });

  drawPlayer();
  drawEnemies();

  bullets.forEach(b=>{ ctx.fillStyle=b.color; ctx.fillRect(b.x,b.y,b.w,b.h); });
  enemyBullets.forEach(eb=>{ ctx.fillStyle = eb.color; ctx.fillRect(eb.x, eb.y, eb.w, eb.h); });
  
  healthPacks.forEach(hp => {
      ctx.fillStyle = hp.glow;
      ctx.beginPath(); ctx.arc(hp.x + hp.w/2, hp.y + hp.h/2, hp.w/2 + 5, 0, Math.PI * 2); ctx.fill();
      ctx.fillStyle = hp.color; ctx.fillRect(hp.x, hp.y, hp.w, hp.h);
      ctx.fillStyle = '#fff';
      ctx.fillRect(hp.x + hp.w/2 - 2, hp.y + 4, 4, hp.h - 8);
      ctx.fillRect(hp.x + 4, hp.y + hp.h/2 - 2, hp.w - 8, 4);
  });

  ctx.fillStyle='#fff'; ctx.font='bold 20px monospace'; ctx.fillText(`Puan: ${score}`, 20, 35);
  ctx.fillText(`Can: ${"â¤ï¸".repeat(player.lives)}`, 20, 65);

  requestAnimationFrame(loop);
}

/* ---------- Start / controls ---------- */
function startPC(){
  document.getElementById('startMenu').style.display='none';
  document.getElementById('mobileControls').style.display='none'; 
  mobileMode = false;
  screenMiddle = canvas.width/2;
  initEntities();
  lastTS = performance.now();
  running = true;
  requestAnimationFrame(loop);
}
function startMobile(){
  document.getElementById('startMenu').style.display='none';
  document.getElementById('mobileControls').style.display='grid'; 
  mobileMode = true;
  screenMiddle = canvas.width/2;
  initEntities();
  lastTS = performance.now();
  running = true;
  requestAnimationFrame(loop);
}

document.getElementById('startBtn').addEventListener('click', ()=>{ ensureAudio(); startPC(); });
document.getElementById('mobileBtn').addEventListener('click', ()=>{ ensureAudio(); startMobile(); });
document.getElementById('howBtn').addEventListener('click', ()=>alert('Hareket: W/A/S/D. SPACE: AteÅŸ. DÃ¼ÅŸman uÃ§aklarÄ±nÄ± dÃ¼ÅŸÃ¼r, can paketlerini topla!'));
document.getElementById('soundBtn').addEventListener('click', ()=>{
  soundOn = !soundOn;
  document.getElementById('soundBtn').innerText = soundOn ? 'Ses: AÃ§' : 'Ses: KapalÄ±';
  if(masterGain) masterGain.gain.value = soundOn ? 0.9 : 0;
});

const upBtn = document.getElementById('upBtn'), downBtn = document.getElementById('downBtn');
const leftBtn = document.getElementById('leftBtn'), rightBtn = document.getElementById('rightBtn'), fireBtn = document.getElementById('fireBtn');

upBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); window._mobileUp = true; });
upBtn.addEventListener('touchend', ()=>{ window._mobileUp = false; });
downBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); window._mobileDown = true; });
downBtn.addEventListener('touchend', ()=>{ window._mobileDown = false; });
leftBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); window._mobileLeft = true; });
leftBtn.addEventListener('touchend', ()=>{ window._mobileLeft = false; });
rightBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); window._mobileRight = true; });
rightBtn.addEventListener('touchend', ()=>{ window._mobileRight = false; });
fireBtn.addEventListener('touchstart', (e)=>{ e.preventDefault(); if(mobileMode) shoot(); });

addEventListener('keydown', e=>{ if(e.key === ' ') shoot(); });

function restartGame(){
  document.getElementById('gameOverScreen').style.display='none';
  initEntities();
  running = true;
  gameOver = false;
  lastTS = performance.now();
  requestAnimationFrame(loop);
}

addEventListener('resize', ()=>{ canvas.width = innerWidth; canvas.height = innerHeight; screenMiddle = canvas.width/2; });
</script>
</body>
</html>
